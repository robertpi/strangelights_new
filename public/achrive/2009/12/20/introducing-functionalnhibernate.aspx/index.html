<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width">
		

		<title>Introducing FunctionalNHibernate</title>

		
		<link rel="stylesheet" href="http://strangelights.com/css/colors-dark.min.217a2547e8e6c808986d22ef70b50263c2d6a4bbc80ed42e97e280a41103f9b5.css">

		
	</head>
	<body>
		<header id="header">
			<h1><a href="http://strangelights.com/">Strangelights</a></h1>
			<p></p>
		</header>

		<div id="page">
			<div id="sidebar">
				<nav>
	
</nav>

			</div>

			<div id="content">
				
	<article class="post">
		<h1><a href="http://strangelights.com/achrive/2009/12/20/introducing-functionalnhibernate.aspx/">Introducing FunctionalNHibernate</a> </h1>

		<div class="post-content">

<p style="MARGIN: 0cm 0cm 10pt" class="MsoNormal"><span style="mso-ansi-language: EN-US" lang="EN-US"><font size="3">It’s already fairly well documented that <a href="http://www.atrevido.net/blog/2009/04/01/Using+Fluent+NHibernate+With+F.aspx">F# doesn’t play too well with NHibernate and Fluent NHibernate</a>, although you can <a href="http://www.atrevido.net/blog/2009/04/23/Update+On+F+With+Fluent+NHibernate.aspx">make it play a littler nice with a bit of effort</a>. However there are a few fundamental problems with this approach. The first is F# class’ are not really designed to be data containers because that’s what its record type is for. The second is that F# class’ do not put too much emphasis on virtual methods as in functional programming we tend to using pass functions as values as a way to achieve polymorphism rather than virtual methods. Third and finally FluentNHibernate works with C#’s expression trees, it would be nice use F#’s quotation system instead. <o:p /></font></span></p>
<p style="MARGIN: 0cm 0cm 10pt" class="MsoNormal"><span style="mso-ansi-language: EN-US" lang="EN-US"><font size="3">Record types are a fixed collection of names and fields a lot like the row in a database. Below shows a record type we’d like to be able to store in a database table. Here we show an invoice record type that we’d like to serialize in the database.<o:p /></font></span></p>
<p style="MARGIN: 0cm 0cm 10pt" class="MsoNormal"><span style="mso-ansi-language: EN-US" lang="EN-US"><o:p><font size="3"><img alt="Record type" src="/blog/Photos/FunNH_record.png" /> </font></o:p></span></p>
<p style="MARGIN: 0cm 0cm 10pt" class="MsoNormal"><span style="mso-ansi-language: EN-US" lang="EN-US"><font size="3">What we’d like to be able to write is a mapping class that describes how it should be serialized, like you can do in FluentNHibernate:<o:p /></font></span></p>
<p style="MARGIN: 0cm 0cm 10pt" class="MsoNormal"><span style="mso-ansi-language: EN-US" lang="EN-US"><o:p><font size="3"><img alt="functional nhibernate mapping" src="/blog/photos/FunNH_mapping.png" /> </font></o:p></span></p>
<p style="MARGIN: 0cm 0cm 10pt" class="MsoNormal"><span style="mso-ansi-language: EN-US" lang="EN-US"><font size="3">The idea of FunctionalNHibernate is to provide a layer to do just this. As you see we provide a neat way to describe the mappings. We achieve the record serialization by providing a custom tupilizer for F# record types. There’s also the start of a wrapper for the SessionFactory that will hopefully allow you to store and retrieve data in way more natural for F#. <o:p /></font></span></p>
<p style="MARGIN: 0cm 0cm 10pt" class="MsoNormal"><span style="mso-ansi-language: EN-US" lang="EN-US"><font size="3">The idea of this project is not to detract from FluentNHibernate, it’s a great project and works really nicely from C#. I want to provide something that will work equally well from F#. We’re a long way behind them and to be honest the project isn’t really usable yet. I have project in mind that I want to use it on, so hopefully I’ll be able to improve it as I go along.<o:p /></font></span></p>
<p style="MARGIN: 0cm 0cm 10pt" class="MsoNormal"><span style="mso-ansi-language: EN-US" lang="EN-US"><font size="3">The result is you can now write the following program to store, update and retrieve our invoice record type:<o:p /></font></span></p>
<p style="MARGIN: 0cm 0cm 10pt" class="MsoNormal"><span style="mso-ansi-language: EN-US" lang="EN-US"><o:p><font size="3"><img alt="fun nhibernate program" src="/blog/photos/FunNH_prog.png" /> </font></o:p></span></p>
<p style="MARGIN: 0cm 0cm 10pt" class="MsoNormal"><span style="mso-ansi-language: EN-US" lang="EN-US"><font size="3">The project is hosted on <a href="http://bitbucket.org/robertpi/functionalnhibernate/">bitbucket.org</a>, where you can explore or download the code. Feel free to drop me a line if you want to help out.<o:p /></font></span></p>

<h3 id="feedback">Feedback:</h3>

<p><em>Feedback was imported from my only blog engine, it&rsquo;s no longer possible to post feedback here.</em></p>

<p><strong>Social comments and analytics for this post - <a href="http://www.ubervu.com/conversations/strangelights.com/blog/archive/2009/12/20/1650.aspx">uberVU - social comments</a></strong></p>

<p>This post was mentioned on Twitter by robertpi: Introducing FunctionalNHibernate: <a rel="nofollow external" href="http://bit.ly/6tSmtE" title="http://bit.ly/6tSmtE"><a href="http://bit.ly/6tSmtE">http://bit.ly/6tSmtE</a></a></p>

<p><strong>The Morning Brew - Chris Alcock  &amp;amp;raquo; The Morning Brew #502 - <a href="http://blog.cwa.me.uk/2009/12/21/the-morning-brew-502/">http://blog.cwa.me.uk/2009/12/21/the-morning-brew-502/</a></strong></p>

<p>The Morning Brew - Chris Alcock  &amp;amp;raquo; The Morning Brew #502</p>

<p><strong>F# Discoveries This Week 12/21/2009 - <a href="http://www.atalasoft.com/cs/blogs/rickm/archive/2009/12/21/f-discoveries-this-week-12-21-2009.aspx">Rick Minerich&rsquo;s Development Wonderland</a></strong></p>

<p>By far the most exciting news this week was the preview release of Microsoft Research Accelerator.&amp;amp;#160;</p>

<p><strong>F# Database Programming &amp;amp;#8211; FunctionalNHibernate? &amp;amp;laquo; Tales from a Trading Desk - <a href="http://mdavey.wordpress.com/2009/12/25/f-database-programming-functionalnhibernate/">http://mdavey.wordpress.com/2009/12/25/f-database-programming-functionalnhibernate/</a></strong></p>

<p>F# Database Programming &amp;amp;#8211; FunctionalNHibernate? &amp;amp;laquo; Tales from a Trading Desk</p>

<p><strong>Xanax. - <a href="http://mehm75.multiply.com/journal/compose">Xanax.</a></strong></p>

<p>Buy xanax without prescription in usa. Xanax. No prescription xanax.</p>

<p><strong>re: Introducing FunctionalNHibernate - Jim Ray</strong></p>

<p>Great article!<br /><br />Nit-pick: the plural of &quot;class&quot; is &quot;classes.&quot;<br /><br /><a rel="nofollow external" href="http://grammar.ccc.commnet.edu/grammar/plurals.htm" title="http://grammar.ccc.commnet.edu/grammar/plurals.htm"><a href="http://grammar.ccc.commnet.edu/grammar/plurals.htm">http://grammar.ccc.commnet.edu/grammar/plurals.htm</a></a></p>
</div>

		<p class="meta">Posted on <span class="postdate">20. December 2009</span></p>
	</article>

			</div>

			<footer id="footer">
				<p class="copyright">
					
						Powered by <a href="https://gohugo.io/">Hugo</a> and the
						<a href="https://github.com/bake/solar-theme-hugo">Solar</a>-theme.
					
				</p>
			</footer>
		</div>

		
	</body>
</html>
